<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„ØµÙˆØªÙŠ Ù„Ù„Ù…Ø¹ØªÙ…Ø±ÙŠÙ† 24/7</title>
<style>
body { font-family: 'Segoe UI', sans-serif; background:#f8f9fa; margin:0; display:flex; flex-direction:column; align-items:center; }
h1 { text-align:center; margin-top:20px; }
#assistant { margin-top:20px; width:90%; max-width:600px; background:white; border-radius:10px; padding:20px; box-shadow:0 2px 10px rgba(0,0,0,0.2);}
#messages { height:300px; overflow-y:auto; border:1px solid #ddd; border-radius:5px; padding:10px; margin-bottom:10px; background:#fafafa;}
.message { margin:5px 0; padding:8px 12px; border-radius:8px; max-width:80%; }
.user { background:#4A90E2; color:white; margin-left:auto; text-align:right;}
.ai { background:#A8E6CF; color:#000; margin-right:auto; text-align:left;}
#controls { display:flex; gap:10px; }
#input { flex:1; padding:10px; font-size:16px; border-radius:5px; border:1px solid #ccc; }
button { padding:10px 15px; font-size:16px; border:none; border-radius:5px; cursor:pointer; background:#009688; color:white; }
button:hover { background:#00796B; }
</style>
</head>
<body>

<h1>Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„ØµÙˆØªÙŠ Ù„Ù„Ù…Ø¹ØªÙ…Ø±ÙŠÙ† 24/7</h1>

<div id="assistant">
  <div id="messages"></div>
  <div id="controls">
    <input type="text" id="input" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ø£Ùˆ Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ† Ù„Ù„ØªØ­Ø¯Ø«">
    <button id="send">Ø¥Ø±Ø³Ø§Ù„</button>
    <button id="voice">ğŸ¤</button>
  </div>
</div>

<script>
const messages = document.getElementById('messages');
const input = document.getElementById('input');
const sendBtn = document.getElementById('send');
const voiceBtn = document.getElementById('voice');

// Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø©
function addMessage(text, sender){
  const div = document.createElement('div');
  div.className = 'message ' + sender;
  div.textContent = text;
  messages.appendChild(div);
  messages.scrollTop = messages.scrollHeight;
}

// ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ ÙƒÙ„Ø§Ù…
function speak(text, lang='ar-SA'){
  if('speechSynthesis' in window){
    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = lang;
    speechSynthesis.speak(utter);
  }
}

// Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ OpenAI API
async function getAIResponse(userText){
  const apiKey = "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";

  const response = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": `Bearer ${apiKey}`
    },
    body: JSON.stringify({
      model: "gpt-4",
      messages: [{role: "user", content: userText}],
      temperature: 0.5
    })
  });

  const data = await response.json();
  return data.choices[0].message.content.trim();
}

// Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
async function sendMessage(){
  const text = input.value.trim();
  if(!text) return;
  addMessage(text, 'user');
  input.value = '';

  try {
    const response = await getAIResponse(text);
    addMessage(response, 'ai');
    speak(response, text.match(/[a-zA-Z]/) ? 'en-US' : 'ar-SA');
  } catch(e){
    addMessage("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ.", 'ai');
    console.error(e);
  }
}

// Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø£Ø²Ø±Ø§Ø±
sendBtn.addEventListener('click', sendMessage);
input.addEventListener('keydown', (e)=>{ if(e.key==='Enter') sendMessage(); });

// ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµÙˆØª
let recognition;
if('SpeechRecognition' in window || 'webkitSpeechRecognition' in window){
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  recognition = new SpeechRecognition();
  recognition.lang = 'ar-SA';
  recognition.continuous = false;
  recognition.interimResults = false;

  recognition.onresult = function(event){
    const speech = event.results[0][0].transcript;
    input.value = speech;
    sendMessage();
  };
  recognition.onerror = function(e){ console.error(e); alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµÙˆØª."); };
}

voiceBtn.addEventListener('click', ()=>{
  if(recognition){
    recognition.start();
  } else {
    alert("Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ† ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ… ÙÙŠ Ù…ØªØµÙØ­Ùƒ.");
  }
});
</script>

</body>
</html>
