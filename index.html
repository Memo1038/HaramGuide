<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù…Ø±Ø´Ø¯ Ø§Ù„Ø­Ø±Ù… Ø§Ù„Ø´Ø§Ù…Ù„ - Ù…Ø­Ù…Ø¯ Ø§Ù„Ø±Ø´ÙŠØ¯ÙŠ</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <style>
        :root { --gold: #c69c6d; --green: #1b5e20; --dark: #121212; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--dark); color: white; height: 100vh; overflow: hidden; }

        /* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨ØµÙˆØ±Ø© Ø§Ù„ÙƒØ¹Ø¨Ø© */
        #welcome-screen {
            position: fixed; inset: 0; z-index: 10000;
            background: linear-gradient(to bottom, rgba(0,0,0,0.4), rgba(0,0,0,0.8)), 
                        url('https://images.unsplash.com/photo-1542810634-71277d95dcbb?q=80&w=1000&auto=format&fit=crop');
            background-size: cover; background-position: center;
            display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; text-align: center;
        }

        .loader-box { border: 4px solid #f3f3f3; border-top: 4px solid var(--gold); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin-bottom: 20px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        #map { height: 100vh; width: 100%; z-index: 1; }

        .ui-overlay { position: absolute; inset: 0; pointer-events: none; z-index: 1000; display: flex; flex-direction: column; }
        .ui-overlay > * { pointer-events: auto; }

        .header { background: rgba(255,255,255,0.95); margin: 10px; padding: 12px; border-radius: 15px; color: var(--green); border-right: 5px solid var(--gold); box-shadow: 0 4px 10px rgba(0,0,0,0.2); font-size: 13px; text-align: center; }

        .menu-container { margin-top: auto; background: white; border-radius: 25px 25px 0 0; padding: 15px; max-height: 55%; overflow-y: auto; color: #333; box-shadow: 0 -5px 20px rgba(0,0,0,0.3); }
        
        .tabs { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 10px; margin-bottom: 10px; border-bottom: 1px solid #eee; }
        .tab { padding: 8px 18px; background: #f0f0f0; border-radius: 20px; font-size: 13px; white-space: nowrap; cursor: pointer; color: #666; font-weight: bold; }
        .tab.active { background: var(--green); color: white; }

        .list-item { display: flex; justify-content: space-between; align-items: center; padding: 14px 5px; border-bottom: 1px solid #f5f5f5; }
        .item-info { display: flex; align-items: center; gap: 8px; }
        .go-btn { background: var(--green); color: white; border: none; padding: 8px 20px; border-radius: 10px; font-size: 13px; font-weight: bold; cursor: pointer; }

        .stats-bar { display: flex; justify-content: space-around; background: #f8f9fa; border: 1px solid #ddd; padding: 12px; border-radius: 15px; margin-top: 10px; color: var(--green); }
        .stats-bar b { display: block; font-size: 18px; color: var(--gold); }
    </style>
</head>
<body onload="requestLocation()">

<div id="welcome-screen">
    <div class="loader-box"></div>
    <h1 style="text-shadow: 2px 2px 10px #000; font-size: 2.2em; margin: 0;">Ù…Ø±Ø´Ø¯ Ø§Ù„Ø­Ø±Ù… Ø§Ù„Ø°ÙƒÙŠ</h1>
    <p style="margin: 10px 0 20px; color: #eee;">Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹Ùƒ Ø¨Ø¯Ù‚Ø© 100%...</p>
    <p style="font-size: 12px; opacity: 0.7;">ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø³Ù…Ø§Ø­" Ø¥Ø°Ø§ Ø¸Ù‡Ø±Øª Ù„Ùƒ</p>
</div>

<div class="ui-overlay">
    <div class="header" id="locStatus">Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ø¨Ø± Ø§Ù„Ø£Ù‚Ù…Ø§Ø± Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©...</div>

    <div class="menu-container">
        <div class="tabs">
            <div class="tab active" onclick="showCat('ground', event)">Ø§Ù„Ø£Ø±Ø¶ÙŠ</div>
            <div class="tab" onclick="showCat('first', event)">Ø§Ù„Ø£ÙˆÙ„</div>
            <div class="tab" onclick="showCat('saei', event)">Ø§Ù„Ø³Ø¹ÙŠ</div>
            <div class="tab" onclick="showCat('toilets', event)">Ø§Ù„Ø­Ù…Ø§Ù…Ø§Øª</div>
            <div class="tab" onclick="showCat('food', event)">Ø§Ù„Ù…Ø·Ø§Ø¹Ù…</div>
        </div>
        <div id="items-list"></div>
        
        <div class="stats-bar">
            <div><b id="d">0</b>Ù…ØªØ±</div>
            <div><b id="s">0</b>Ø®Ø·ÙˆØ©</div>
            <div><b id="t">0</b>Ø¯Ù‚ÙŠÙ‚Ø©</div>
        </div>
    </div>
</div>

<div id="map"></div>

<script>
    const data = {
        ground: [
            { name: "Ø¨Ø§Ø¨ Ø§Ù„Ù…Ù„Ùƒ Ø¹Ø¨Ø¯ Ø§Ù„Ø¹Ø²ÙŠØ² (1)", lat: 21.4204, lng: 39.8257 },
            { name: "Ø¨Ø§Ø¨ Ø§Ù„Ù…Ù„Ùƒ ÙÙ‡Ø¯ (79)", lat: 21.4214, lng: 39.8235 },
            { name: "Ø¨Ø§Ø¨ Ø§Ù„Ø¹Ù…Ø±Ø© (62)", lat: 21.4237, lng: 39.8248 },
            { name: "Ø¨Ø§Ø¨ Ø§Ù„ÙØªØ­ (45)", lat: 21.4246, lng: 39.8263 },
            { name: "ØµØ­Ù† Ø§Ù„Ù…Ø·Ø§Ù", lat: 21.4225, lng: 39.8262 }
        ],
        first: [
            { name: "Ø¨Ø§Ø¨ 74 (Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø£ÙˆÙ„)", lat: 21.4215, lng: 39.8229 },
            { name: "Ø¬Ø³Ø± Ø£Ø¬ÙŠØ§Ø¯ (Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø£ÙˆÙ„)", lat: 21.4198, lng: 39.8255 },
            { name: "ØªÙˆØ³Ø¹Ø© Ø§Ù„Ù…Ù„Ùƒ ÙÙ‡Ø¯ - Ø§Ù„Ø£ÙˆÙ„", lat: 21.4220, lng: 39.8230 }
        ],
        saei: [
            { name: "Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø³Ø¹ÙŠ (Ø§Ù„ØµÙØ§) ğŸš©", lat: 21.4215, lng: 39.8275 },
            { name: "Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø³Ø¹ÙŠ (Ø§Ù„Ù…Ø±ÙˆØ©) ğŸ", lat: 21.4255, lng: 39.8282 }
        ],
        toilets: [
            { name: "Ø­Ù…Ø§Ù…Ø§Øª Ø§Ù„Ù‚Ø´Ø§Ø´ÙŠØ©", lat: 21.4245, lng: 39.8305 },
            { name: "Ø­Ù…Ø§Ù…Ø§Øª Ø§Ù„Ø´Ø¨ÙŠÙƒØ©", lat: 21.4210, lng: 39.8210 },
            { name: "Ø­Ù…Ø§Ù…Ø§Øª Ø§Ù„Ø³Ø§Ø­Ø© Ø§Ù„Ø´Ù…Ø§Ù„ÙŠØ©", lat: 21.4265, lng: 39.8250 }
        ],
        food: [
            { name: "Ù…Ø·Ø¹Ù… Ø§Ù„Ø¨ÙŠÙƒ (Ø¬Ø¨Ù„ Ø¹Ù…Ø±)", lat: 21.4210, lng: 39.8200 },
            { name: "Ø£Ø¨Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØª (Ø§Ù„Ù…Ø·Ø§Ø¹Ù…)", lat: 21.4188, lng: 39.8256 }
        ]
    };

    let map, userMkr, targetMkr, path;

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø¨ØµÙˆØ± Esri Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¯Ù‚Ø©
    map = L.map('map', { zoomControl: false }).setView([21.4225, 39.8262], 18);
    L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', { maxZoom: 19 }).addTo(map);
    path = L.polyline([], {color: '#c69c6d', weight: 6, dashArray: '1, 10'}).addTo(map);

    function requestLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.watchPosition(success, error, {
                enableHighAccuracy: true,
                maximumAge: 0
            });
        }
    }

    function success(pos) {
        document.getElementById('welcome-screen').style.display = 'none';
        const uPos = [pos.coords.latitude, pos.coords.longitude];
        
        if (!userMkr) {
            userMkr = L.circleMarker(uPos, {radius: 9, color: '#fff', weight: 3, fillOpacity: 1, fillColor: '#007aff'}).addTo(map);
            map.panTo(uPos);
        } else {
            userMkr.setLatLng(uPos);
        }
        
        document.getElementById('locStatus').innerText = "ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹Ùƒ Ø¨Ø¯Ù‚Ø© Ø¹Ø§Ù„ÙŠØ© âœ…";
        if(targetMkr) updateNav(uPos, targetMkr.getLatLng());
    }

    function error() {
        document.getElementById('locStatus').innerText = "âŒ ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ù† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª";
    }

    function showCat(cat, event) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        if(event) event.target.classList.add('active');

        const list = document.getElementById('items-list');
        list.innerHTML = '';
        data[cat].forEach(item => {
            const div = document.createElement('div');
            div.className = 'list-item';
            div.innerHTML = `<div class="item-info">ğŸ“ <span>${item.name}</span></div> 
                             <button class="go-btn" onclick="setTarget(${item.lat}, ${item.lng})">Ø§Ù†ØªÙ‚Ø§Ù„</button>`;
            list.appendChild(div);
        });
    }

    function setTarget(lat, lng) {
        if(targetMkr) map.removeLayer(targetMkr);
        targetMkr = L.marker([lat, lng]).addTo(map);
        
        const u = userMkr.getLatLng();
        map.fitBounds(L.latLngBounds([u, [lat, lng]]), {padding: [50, 160]});
        updateNav([u.lat, u.lng], [lat, lng]);
    }

    function updateNav(u, t) {
        let d = map.distance(u, t);
        document.getElementById('d').innerText = Math.round(d);
        document.getElementById('s').innerText = Math.round(d / 0.7);
        document.getElementById('t').innerText = Math.round(d / 70);
        path.setLatLngs([u, t]);
    }

    showCat('ground'); // Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
</script>
</body>
</html>
