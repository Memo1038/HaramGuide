<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù…Ø±Ø´Ø¯ Ø§Ù„Ø­Ø±Ù… Ø§Ù„Ø´Ø§Ù…Ù„ - Ù…Ø­Ù…Ø¯ Ø§Ù„Ø±Ø´ÙŠØ¯ÙŠ</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <style>
        :root { --gold: #c69c6d; --green: #1b5e20; --dark: #121212; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--dark); color: white; height: 100vh; overflow: hidden; }

        #welcome-screen {
            position: fixed; inset: 0; z-index: 10000;
            background: linear-gradient(to bottom, rgba(0,0,0,0.4), rgba(0,0,0,0.8)), 
                        url('https://images.unsplash.com/photo-1565019053020-13365846a10a?q=80&w=1000&auto=format&fit=crop');
            background-size: cover; background-position: center;
            display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; text-align: center;
        }
        .start-btn { 
            background: var(--gold); color: white; border: none; padding: 18px 60px; 
            border-radius: 50px; font-size: 20px; font-weight: bold; cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        #map { height: 100vh; width: 100%; z-index: 1; }

        .ui-overlay { position: absolute; inset: 0; pointer-events: none; z-index: 1000; display: flex; flex-direction: column; }
        .ui-overlay > * { pointer-events: auto; }

        .header { background: rgba(255,255,255,0.95); margin: 10px; padding: 12px; border-radius: 15px; color: var(--green); border-right: 5px solid var(--gold); box-shadow: 0 4px 10px rgba(0,0,0,0.2); font-size: 13px; }

        .menu-container { margin-top: auto; background: white; border-radius: 25px 25px 0 0; padding: 15px; max-height: 55%; overflow-y: auto; color: #333; box-shadow: 0 -5px 20px rgba(0,0,0,0.3); }
        
        .tabs { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 10px; margin-bottom: 10px; border-bottom: 1px solid #eee; }
        .tab { padding: 8px 18px; background: #f0f0f0; border-radius: 20px; font-size: 13px; white-space: nowrap; cursor: pointer; color: #666; font-weight: bold; }
        .tab.active { background: var(--green); color: white; }

        .list-item { display: flex; justify-content: space-between; align-items: center; padding: 14px 5px; border-bottom: 1px solid #f5f5f5; }
        .item-info { display: flex; align-items: center; gap: 8px; }
        .go-btn { background: var(--green); color: white; border: none; padding: 8px 20px; border-radius: 10px; font-size: 13px; font-weight: bold; }

        .stats-bar { display: flex; justify-content: space-around; background: #f8f9fa; border: 1px solid #ddd; padding: 12px; border-radius: 15px; margin-top: 10px; color: var(--green); }
        .stats-bar b { display: block; font-size: 18px; color: var(--gold); }
    </style>
</head>
<body>

<div id="welcome-screen">
    <h1 style="text-shadow: 2px 2px 10px #000; font-size: 2.2em;">Ù…Ø±Ø´Ø¯ Ø§Ù„Ø­Ø±Ù… Ø§Ù„Ø°ÙƒÙŠ</h1>
    <p style="margin-bottom: 40px;">Ø¯Ù„ÙŠÙ„Ùƒ Ø§Ù„Ø´Ø§Ù…Ù„ Ù„Ù„Ø£Ø¨ÙˆØ§Ø¨ ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª</p>
    <button class="start-btn" onclick="startApp()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø®Ø±ÙŠØ·Ø©</button>
</div>

<div class="ui-overlay">
    <div class="header" id="userLoc">Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹Ùƒ Ø¨Ø¯Ù‚Ø©...</div>

    <div class="menu-container">
        <div class="tabs" id="tabs">
            <div class="tab active" onclick="showCat('ground', event)">Ø§Ù„Ø£Ø±Ø¶ÙŠ</div>
            <div class="tab" onclick="showCat('first', event)">Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø£ÙˆÙ„</div>
            <div class="tab" onclick="showCat('toilets', event)">Ø¯ÙˆØ±Øª Ø§Ù„Ù…ÙŠØ§Ù‡</div>
            <div class="tab" onclick="showCat('saei', event)">Ø§Ù„Ø³Ø¹ÙŠ</div>
            <div class="tab" onclick="showCat('services', event)">Ø§Ù„Ù…ÙˆØ§Ù‚Ù ÙˆØ§Ù„Ø¨Ø§ØµØ§Øª</div>
        </div>
        <div id="items-list"></div>
        
        <div class="stats-bar">
            <div><b id="d">0</b>Ù…ØªØ±</div>
            <div><b id="s">0</b>Ø®Ø·ÙˆØ©</div>
            <div><b id="t">0</b>Ø¯Ù‚ÙŠÙ‚Ø©</div>
        </div>
    </div>
</div>

<div id="map"></div>

<script>
    const data = {
        ground: [
            { name: "Ø¨Ø§Ø¨ Ø§Ù„Ù…Ù„Ùƒ Ø¹Ø¨Ø¯ Ø§Ù„Ø¹Ø²ÙŠØ² (1)", lat: 21.4204, lng: 39.8257 },
            { name: "Ø¨Ø§Ø¨ Ø§Ù„Ù…Ù„Ùƒ ÙÙ‡Ø¯ (79)", lat: 21.4214, lng: 39.8235 },
            { name: "Ø¨Ø§Ø¨ Ø§Ù„Ø¹Ù…Ø±Ø© (62)", lat: 21.4237, lng: 39.8248 },
            { name: "Ø¨Ø§Ø¨ Ø§Ù„ÙØªØ­ (45)", lat: 21.4246, lng: 39.8263 },
            { name: "ØµØ­Ù† Ø§Ù„Ù…Ø·Ø§Ù", lat: 21.4225, lng: 39.8262 }
        ],
        first: [
            { name: "Ø¨Ø§Ø¨ Ø§Ù„Ù…Ù„Ùƒ ÙÙ‡Ø¯ - Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø£ÙˆÙ„", lat: 21.4212, lng: 39.8233 },
            { name: "Ø¬Ø³Ø± Ø£Ø¬ÙŠØ§Ø¯", lat: 21.4198, lng: 39.8255 },
            { name: "Ù…ØµÙ„Ù‰ Ø§Ù„Ù†Ø³Ø§Ø¡ - Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø£ÙˆÙ„", lat: 21.4235, lng: 39.8250 },
            { name: "Ù…Ø³Ø§Ø± Ø§Ù„Ø¹Ø±Ø¨Ø§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©", lat: 21.4242, lng: 39.8272 }
        ],
        toilets: [
            { name: "Ø­Ù…Ø§Ù…Ø§Øª Ø§Ù„Ø³Ø§Ø­Ø© Ø§Ù„Ø´Ø±Ù‚ÙŠØ© (Ø§Ù„Ù‚Ø´Ø§Ø´ÙŠØ©)", lat: 21.4245, lng: 39.8305 },
            { name: "Ø­Ù…Ø§Ù…Ø§Øª Ø§Ù„Ø³Ø§Ø­Ø© Ø§Ù„Ø´Ù…Ø§Ù„ÙŠØ©", lat: 21.4265, lng: 39.8250 },
            { name: "Ø­Ù…Ø§Ù…Ø§Øª Ø§Ù„Ø³Ø§Ø­Ø© Ø§Ù„ØºØ±Ø¨ÙŠØ© (Ø§Ù„Ø´Ø¨ÙŠÙƒØ©)", lat: 21.4210, lng: 39.8210 },
            { name: "Ø­Ù…Ø§Ù…Ø§Øª Ø§Ù„Ù…Ø³ÙÙ„Ø©", lat: 21.4185, lng: 39.8250 }
        ],
        saei: [
            { name: "Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù…Ø³Ø¹Ù‰ (Ø§Ù„ØµØ§ÙØ§) ğŸš©", lat: 21.4215, lng: 39.8275 },
            { name: "Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ø³Ø¹Ù‰ (Ø§Ù„Ù…Ø±ÙˆØ©) ğŸ", lat: 21.4255, lng: 39.8282 },
            { name: "ÙˆØ³Ø· Ø§Ù„Ù…Ø³Ø¹Ù‰ - Ø¹Ø±Ø¨Ø§Øª", lat: 21.4235, lng: 39.8278 }
        ],
        services: [
            { name: "Ù…ÙˆØ§Ù‚Ù Ø¨Ø§ØµØ§Øª ÙƒØ¯ÙŠ", lat: 21.4175, lng: 39.8295 },
            { name: "Ù…ÙˆØ§Ù‚Ù Ø¨Ø§ØµØ§Øª Ø£Ø¬ÙŠØ§Ø¯", lat: 21.4180, lng: 39.8310 },
            { name: "Ù…Ø·Ø¹Ù… Ø§Ù„Ø¨ÙŠÙƒ - Ø¬Ø¨Ù„ Ø¹Ù…Ø±", lat: 21.4210, lng: 39.8200 }
        ]
    };

    let map, userMkr, targetMkr, path;

    map = L.map('map', { zoomControl: false }).setView([21.4225, 39.8262], 18);
    L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', { maxZoom: 19 }).addTo(map);
    path = L.polyline([], {color: '#c69c6d', weight: 6, dashArray: '1, 10'}).addTo(map);

    function startApp() {
        document.getElementById('welcome-screen').style.display = 'none';
        if (navigator.geolocation) {
            navigator.geolocation.watchPosition(pos => {
                const u = [pos.coords.latitude, pos.coords.longitude];
                if (!userMkr) {
                    userMkr = L.circleMarker(u, {radius: 10, color: '#fff', weight: 3, fillOpacity: 1, fillColor: '#007aff'}).addTo(map);
                    map.panTo(u);
                } else { userMkr.setLatLng(u); }
                document.getElementById('userLoc').innerHTML = "Ù…ÙˆÙ‚Ø¹Ùƒ Ø§Ù„Ø¢Ù†: <b>Ø¯Ù‚Ø© Ø¹Ø§Ù„ÙŠØ© Ù…ØªÙˆÙØ±Ø©</b>";
                if(targetMkr) updateNav(u, targetMkr.getLatLng());
            }, null, {enableHighAccuracy: true});
        }
        showCat('ground');
    }

    function showCat(cat, event) {
        if(event) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
        }

        const list = document.getElementById('items-list');
        list.innerHTML = '';
        data[cat].forEach(item => {
            const div = document.createElement('div');
            div.className = 'list-item';
            div.innerHTML = `<div class="item-info">ğŸ“ <span>${item.name}</span></div> 
                             <button class="go-btn" onclick="setTarget(${item.lat}, ${item.lng})">Ø§Ù†ØªÙ‚Ø§Ù„</button>`;
            list.appendChild(div);
        });
    }

    function setTarget(lat, lng) {
        if(targetMkr) map.removeLayer(targetMkr);
        targetMkr = L.marker([lat, lng]).addTo(map);
        
        const userPos = userMkr ? userMkr.getLatLng() : [21.4225, 39.8262];
        map.fitBounds(L.latLngBounds([userPos, [lat, lng]]), {padding: [50, 160]});
        updateNav([userPos.lat, userPos.lng], [lat, lng]);
    }

    function updateNav(u, t) {
        let dist = map.distance(u, t);
        document.getElementById('d').innerText = Math.round(dist);
        document.getElementById('s').innerText = Math.round(dist / 0.7);
        document.getElementById('t').innerText = Math.round(dist / 70);
        path.setLatLngs([u, t]);
    }
</script>
</body>
</html>
